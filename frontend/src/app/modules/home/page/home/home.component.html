<div class="form">
	<div class="block">
		<form [formGroup]="roadmapForm" (ngSubmit)="createRoadmap()">
			<app-input
				controlName="name"
				inputName="reg-email"
				label="Название"
				type="text"
				required="true"
			></app-input>
			<app-input
				controlName="description"
				inputName="reg-email"
				label="Описание"
				type="text"
				required="true"
			></app-input>
			<app-button
				text="Создать план развития"
				type="submit"
				size="sm"
			></app-button>
		</form>
	</div>

	<div class="block">
		<form [formGroup]="stageForm" (ngSubmit)="createStage()">
			<mat-form-field appearance="fill">
				<mat-label>План развития</mat-label>
				<mat-select [(ngModel)]="selectedValue" formControlName="roadmapId">
					<mat-option *ngFor="let map of roadmaps" [value]="map.id">
						{{ map.name }}
					</mat-option>
				</mat-select>
			</mat-form-field>
			<app-input
				controlName="name"
				inputName="reg-email"
				label="Состав этапа"
				type="text"
				required="true"
			></app-input>
			<app-button text="Создать этап" type="submit" size="sm"></app-button>
		</form>
	</div>
</div>

<div>
	<p *ngIf="loading; else roadmapContent">Загружается...</p>
	<ng-template #roadmapContent>
		<table mat-table [dataSource]="roadmaps" class="mat-elevation-z8">
			<ng-container matColumnDef="name">
				<th mat-header-cell *matHeaderCellDef>Название</th>
				<td mat-cell *matCellDef="let roadmap">{{ roadmap.name }}</td>
			</ng-container>

			<ng-container matColumnDef="description">
				<th mat-header-cell *matHeaderCellDef>Описание</th>
				<td mat-cell *matCellDef="let roadmap">{{ roadmap.description }}</td>
			</ng-container>

			<tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
			<tr
				mat-row
				*matRowDef="let row; columns: displayedColumns"
				(click)="getRecord(row)"
			></tr>
		</table>
	</ng-template>
</div>

<div class="stage">
  <div *ngFor="let map of roadmaps">
    {{map.name}}
    <div *ngFor="let stage of map.stages">
      {{stage.name}} - {{stage.path}}
    </div>
  </div>
</div>

<mat-tree [dataSource]="dataSource" [treeControl]="treeControl" class="example-tree">
  <!-- This is the tree node template for leaf nodes -->
  <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle>
    <li class="mat-tree-node">
      <!-- use a disabled button to provide padding for tree leaf -->
      <button mat-icon-button disabled></button>
      {{node.name}}
    </li>
  </mat-tree-node>
  <!-- This is the tree node template for expandable nodes -->
  <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
    <li>
      <div class="mat-tree-node">
        <button mat-icon-button matTreeNodeToggle
                [attr.aria-label]="'Toggle ' + node.name">
          <mat-icon class="mat-icon-rtl-mirror">
            {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
          </mat-icon>
        </button>
        {{node.name}}
      </div>
      <ul [class.example-tree-invisible]="!treeControl.isExpanded(node)">
        <ng-container matTreeNodeOutlet></ng-container>
      </ul>
    </li>
  </mat-nested-tree-node>
</mat-tree>

<!--<div class="stage">
	<table mat-table [dataSource]="stages" class="mat-elevation-z8">
		<ng-container matColumnDef="content">
			<th mat-header-cell *matHeaderCellDef>Состав плана развития</th>
			<td mat-cell *matCellDef="let stage">{{ stage.name }}</td>
		</ng-container>

    <ng-container matColumnDef="completed">
      <th mat-header-cell *matHeaderCellDef>Выполнен</th>
      <td mat-cell *matCellDef="let stage;">
        <mat-checkbox value="false"></mat-checkbox>
      </td>
    </ng-container>

		<tr mat-header-row *matHeaderRowDef="displayedColumnsStages"></tr>
		<tr mat-row *matRowDef="let row; columns: displayedColumnsStages"></tr>
	</table>
</div>-->
